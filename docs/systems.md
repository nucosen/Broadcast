# システム構造

NUCOSen BroadcastはPythonパッケージです。
つまり、複数の小規模なPythonプログラム（モジュール）の複合体として全体のシステムが構築されています。

以下では、各プログラムについて簡易的に説明します。
なお、おおよそ呼び出される順で記述してあります。

## cli.py

サーバーで`nucosen`コマンドが実行されるときに、最初に呼び出されるプログラムです。
ロギングの手配を行い、nucosen.pyを呼び出します。

## discordHandler.py

Python標準のロギングシステムと協調して稼働するプログラムです。
警告以上のログが発生した際に、Discordへと転送します。

## nucosen.py

最も規模の大きいプログラムです。
環境変数や設定ファイルを読み込み、各プログラムを呼び出して初期情報を与えます。

## clock.py

時間計測を行うプログラムです。
現在は、「放送開始まで待機」するためのみに使用されています。

## db.py

データベースとの通信を担当するプログラムです。
リクエストを読み取り、放送キューを作成してデータベースに保管します。

## live.py

ニコニコ生放送との通信を担当するプログラムです。
枠の予約を行い、引用の開始・停止を指示したり、生主コメントを投稿したりします。

## sessionCookie.py

ニコニコと通信する際に認証を行うためのプログラムです。
ログイン済みの通信セッションをニコニコとの間で成立させ、他のプログラムに提供します。

## personality.py

リクエストが無い間、放送内容を決定するためのプログラムです。
いまのところ、該当タグを持つ動画の中からランダムに動画を選出します。

## quote.py

動画情報を管理するプログラムです。
特定の動画が引用可能か判断し、動画名や引用時間などの情報を他プログラムに提供します。

## __init__.py

パッケージを1つの大きなプログラムとして読み込む際に使用されます。
そのような用途は想定されていないため、内容はバージョン情報が書かれているだけです。

## その他のプログラム

パッケージに含まれないがNUCOSen Broadcastで使用されているプログラム

- test.py
  - 動作試験やプログラム作成時に一時的に使用するコードが記述されます。
- setup.py
  - NUCOSen Broadcastパッケージをインストールする際に、外部プログラムとの依存関係を解決するための内容などが含まれています。

[表紙に戻る](index.md)